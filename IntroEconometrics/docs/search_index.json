[["OLS.html", "Rで計量経済学 Chapter 1 回帰分析 1.1 検証する仮説 1.2 データの読み込み 1.3 データの把握 1.4 単回帰分析 1.5 重回帰分析 1 1.6 重回帰分析 2 1.7 捕捉", " Rで計量経済学 Tomoya Ozawa Last Update: 02/11/2021 Chapter 1 回帰分析 1.1 検証する仮説 「教育年数が増えると,賃金は増加するのでは?」という仮説を検証していきます 1.2 データの読み込み df &lt;- read.csv(&quot;data/female_labor.csv&quot;) head(df) ## working_hours age education hourly_wage mother_edu ## 1 4950 35 12 0.1616 10 ## 2 4210 46 12 2.3753 3 ## 3 3686 32 14 0.5426 12 ## 4 3640 58 12 1.0989 7 ## 5 3533 38 15 5.0948 12 ## 6 3225 54 16 3.0416 12 ## father_edu number_kids_under6 number_kids_6to18 ## 1 10 0 2 ## 2 3 0 0 ## 3 12 0 0 ## 4 3 0 0 ## 5 7 2 2 ## 6 12 0 0 1.3 データの把握 1.3.1 ヒストグラム hist(df$education) hist(df$hourly_wage) 1.3.2 散布図 plot(df$education, df$hourly_wage) 1.3.3 基本統計量 summary(df) ## working_hours age education ## Min. : 0.0 Min. :30.00 Min. : 5.00 ## 1st Qu.: 0.0 1st Qu.:36.00 1st Qu.:12.00 ## Median : 288.0 Median :43.00 Median :12.00 ## Mean : 740.6 Mean :42.54 Mean :12.29 ## 3rd Qu.:1516.0 3rd Qu.:49.00 3rd Qu.:13.00 ## Max. :4950.0 Max. :60.00 Max. :17.00 ## ## hourly_wage mother_edu father_edu ## Min. : 0.000 Min. : 3.000 Min. : 3.000 ## 1st Qu.: 0.000 1st Qu.: 7.000 1st Qu.: 7.000 ## Median : 1.625 Median :10.000 Median : 7.000 ## Mean : 2.375 Mean : 9.414 Mean : 8.988 ## 3rd Qu.: 3.788 3rd Qu.:12.000 3rd Qu.:12.000 ## Max. :25.000 Max. :17.000 Max. :17.000 ## NA&#39;s :13 NA&#39;s :15 ## number_kids_under6 number_kids_6to18 ## Min. :0.0000 Min. :0.000 ## 1st Qu.:0.0000 1st Qu.:0.000 ## Median :0.0000 Median :1.000 ## Mean :0.2377 Mean :1.353 ## 3rd Qu.:0.0000 3rd Qu.:2.000 ## Max. :3.0000 Max. :8.000 ## 1.4 単回帰分析 1.4.1 計量経済学モデル \\[ hourly\\_wage_{i} = \\alpha + \\beta\\times education_{i} + u_{i} \\] 1.4.2 推定 out_simple_regress &lt;- lm(hourly_wage ~ education, data = df) 1.4.3 解釈 summary(out_simple_regress) ## ## Call: ## lm(formula = hourly_wage ~ education, data = df) ## ## Residuals: ## Min 1Q Median 3Q Max ## -4.5079 -2.2447 -0.4342 1.3737 22.7553 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -3.18694 0.61456 -5.186 2.77e-07 *** ## education 0.45264 0.04918 9.204 &lt; 2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 3.075 on 751 degrees of freedom ## Multiple R-squared: 0.1014, Adjusted R-squared: 0.1002 ## F-statistic: 84.71 on 1 and 751 DF, p-value: &lt; 2.2e-16 plot(df$education, df$hourly_wage) abline(out_simple_regress, col = &quot;blue&quot;) 1.5 重回帰分析 1 1.5.1 計量経済学モデル \\[ hourly\\_wage_{i} = \\alpha + \\beta_{1}\\times education_{i}+ \\beta_{2}\\times working\\_hours_{i}+ \\beta_{3}\\times number\\_kids_{i} + u_{i} \\] 1.5.2 データの加工: 新規変数作成 df$number_kids &lt;- df$number_kids_under6 + df$number_kids_6to18 head(df) ## working_hours age education hourly_wage mother_edu ## 1 4950 35 12 0.1616 10 ## 2 4210 46 12 2.3753 3 ## 3 3686 32 14 0.5426 12 ## 4 3640 58 12 1.0989 7 ## 5 3533 38 15 5.0948 12 ## 6 3225 54 16 3.0416 12 ## father_edu number_kids_under6 number_kids_6to18 ## 1 10 0 2 ## 2 3 0 0 ## 3 12 0 0 ## 4 3 0 0 ## 5 7 2 2 ## 6 12 0 0 ## number_kids ## 1 2 ## 2 0 ## 3 0 ## 4 0 ## 5 4 ## 6 0 1.5.3 推定 out_multi_regress_1 &lt;- lm(hourly_wage ~ education + working_hours + number_kids, data = df ) 1.5.4 解釈 summary(out_multi_regress_1) ## ## Call: ## lm(formula = hourly_wage ~ education + working_hours + number_kids, ## data = df) ## ## Residuals: ## Min 1Q Median 3Q Max ## -8.1966 -1.2120 -0.6863 0.6766 23.7459 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -3.4649784 0.5749260 -6.027 2.62e-09 *** ## education 0.3934232 0.0450934 8.725 &lt; 2e-16 *** ## working_hours 0.0014526 0.0001196 12.148 &lt; 2e-16 *** ## number_kids -0.0440836 0.0709400 -0.621 0.535 ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 2.804 on 749 degrees of freedom ## Multiple R-squared: 0.255, Adjusted R-squared: 0.252 ## F-statistic: 85.44 on 3 and 749 DF, p-value: &lt; 2.2e-16 1.6 重回帰分析 2 1.6.1 計量経済学モデル \\[ hourly\\_wage_{i} = \\alpha + \\beta_{1}\\times education_{i}+ \\beta_{2}\\times age_{i} + \\beta_{3}\\times working\\_dummy_{i} + \\beta_{4}\\times mother\\_edu_{i} + \\beta_{5}\\times father\\_edu_{i} + u_{i} \\] 1.6.2 データの加工: 欠損値の補完 # dfの欠損値を全て0にする df[is.na(df)] &lt;- 0 # あるいはdfのmother_eduという列の欠損値を0にする df$mother_edu[is.na(df$mother_edu)] &lt;- 0 1.6.3 データの加工: ダミー変数 df$working_dummy &lt;- ifelse(df$working_hours&gt;0, 1,0) 1.6.4 推定 out_multi_regress_2 &lt;- lm(hourly_wage ~ education + age + working_dummy + mother_edu + father_edu, data = df ) 1.6.5 解釈 summary(out_multi_regress_2) ## ## Call: ## lm(formula = hourly_wage ~ education + age + working_dummy + ## mother_edu + father_edu, data = df) ## ## Residuals: ## Min 1Q Median 3Q Max ## -5.0947 -1.0751 -0.1532 0.4714 21.2530 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -3.91624 0.72697 -5.387 9.60e-08 *** ## education 0.33486 0.04491 7.455 2.49e-13 *** ## age 0.01127 0.01120 1.006 0.3147 ## working_dummy 3.93952 0.18062 21.811 &lt; 2e-16 *** ## mother_edu -0.05665 0.03328 -1.702 0.0891 . ## father_edu -0.00206 0.03108 -0.066 0.9472 ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 2.405 on 747 degrees of freedom ## Multiple R-squared: 0.4532, Adjusted R-squared: 0.4495 ## F-statistic: 123.8 on 5 and 747 DF, p-value: &lt; 2.2e-16 1.7 捕捉 1.7.1 多重共線性 cor(df) ## working_hours age education ## working_hours 1.00000000 -0.03311418 0.10596042 ## age -0.03311418 1.00000000 -0.12022299 ## education 0.10596042 -0.12022299 1.00000000 ## hourly_wage 0.42294447 -0.03455914 0.31837807 ## mother_edu 0.05786375 -0.23464156 0.43533650 ## father_edu 0.01367090 -0.16059085 0.44245823 ## number_kids_under6 -0.22206330 -0.43394869 0.10869022 ## number_kids_6to18 -0.09063207 -0.38541134 -0.05889891 ## number_kids -0.16157352 -0.50398872 -0.01423498 ## working_dummy 0.74114539 -0.08049811 0.18735285 ## hourly_wage mother_edu father_edu ## working_hours 0.42294447 0.05786375 0.01367090 ## age -0.03455914 -0.23464156 -0.16059085 ## education 0.31837807 0.43533650 0.44245823 ## hourly_wage 1.00000000 0.09030522 0.09847684 ## mother_edu 0.09030522 1.00000000 0.57307174 ## father_edu 0.09847684 0.57307174 1.00000000 ## number_kids_under6 -0.12289534 0.10782888 0.09607595 ## number_kids_6to18 -0.04734860 0.03238278 -0.02683041 ## number_kids -0.08687983 0.06794962 0.01022068 ## working_dummy 0.63870803 0.09048973 0.05771841 ## number_kids_under6 number_kids_6to18 ## working_hours -0.22206330 -0.090632070 ## age -0.43394869 -0.385411341 ## education 0.10869022 -0.058898912 ## hourly_wage -0.12289534 -0.047348598 ## mother_edu 0.10782888 0.032382782 ## father_edu 0.09607595 -0.026830408 ## number_kids_under6 1.00000000 0.084159872 ## number_kids_6to18 0.08415987 1.000000000 ## number_kids 0.43481542 0.933918807 ## working_dummy -0.21374930 -0.002424231 ## number_kids working_dummy ## working_hours -0.16157352 0.741145387 ## age -0.50398872 -0.080498109 ## education -0.01423498 0.187352846 ## hourly_wage -0.08687983 0.638708027 ## mother_edu 0.06794962 0.090489728 ## father_edu 0.01022068 0.057718407 ## number_kids_under6 0.43481542 -0.213749303 ## number_kids_6to18 0.93391881 -0.002424231 ## number_kids 1.00000000 -0.078875105 ## working_dummy -0.07887511 1.000000000 library(psych) cor.plot(cor(df)) library(car) vif(out_multi_regress_2) ## education age working_dummy mother_edu ## 1.363415 1.063368 1.041688 1.632560 ## father_edu ## 1.602159 "],["IV.html", "Chapter 2 操作変数法 2.1 検証する仮説 2.2 データの読み込み 2.3 データの把握 2.4 推定 2.5 推定結果の整理", " Chapter 2 操作変数法 2.1 検証する仮説 2.2 データの読み込み df &lt;- read.csv(&#39;data/labsup_edited.csv&#39;) head(df) ## morekids boy1st boy2nd samesex agem1 black hispan othrace ## 1 0 1 0 0 27 0 0 0 ## 2 0 0 1 0 30 0 0 0 ## 3 0 1 0 0 27 0 0 0 ## 4 0 1 0 0 35 1 0 0 ## 5 0 0 0 1 30 0 0 0 ## 6 0 1 0 0 26 0 0 0 ## weeksm1 ## 1 0 ## 2 30 ## 3 0 ## 4 0 ## 5 22 ## 6 40 2.3 データの把握 summary(df) ## morekids boy1st boy2nd ## Min. :0.0000 Min. :0.0000 Min. :0.0000 ## 1st Qu.:0.0000 1st Qu.:0.0000 1st Qu.:0.0000 ## Median :0.0000 Median :1.0000 Median :1.0000 ## Mean :0.3806 Mean :0.5144 Mean :0.5126 ## 3rd Qu.:1.0000 3rd Qu.:1.0000 3rd Qu.:1.0000 ## Max. :1.0000 Max. :1.0000 Max. :1.0000 ## samesex agem1 black ## Min. :0.0000 Min. :21.00 Min. :0.00000 ## 1st Qu.:0.0000 1st Qu.:28.00 1st Qu.:0.00000 ## Median :1.0000 Median :31.00 Median :0.00000 ## Mean :0.5056 Mean :30.39 Mean :0.05166 ## 3rd Qu.:1.0000 3rd Qu.:33.00 3rd Qu.:0.00000 ## Max. :1.0000 Max. :35.00 Max. :1.00000 ## hispan othrace weeksm1 ## Min. :0.00000 Min. :0.00000 Min. : 0.00 ## 1st Qu.:0.00000 1st Qu.:0.00000 1st Qu.: 0.00 ## Median :0.00000 Median :0.00000 Median : 5.00 ## Mean :0.07421 Mean :0.05634 Mean :19.02 ## 3rd Qu.:0.00000 3rd Qu.:0.00000 3rd Qu.:44.00 ## Max. :1.00000 Max. :1.00000 Max. :52.00 2.4 推定 2.4.1 計量経済学モデル \\[ weeksm1_{i} = \\alpha + \\beta_{1}\\times morekids_{i}+ \\beta_{2}\\times agem1_{i}+ \\beta_{3}\\times black_{i}+ \\beta_{4}\\times hispan_{i} + \\beta_{5}\\times othrace_{i} + u_{i} \\] \\[ morekids_{i} = \\alpha + \\beta_{1}\\times samesex_{i}+ \\beta_{2}\\times agem1_{i}+ \\beta_{3}\\times black_{i}+ \\beta_{4}\\times hispan_{i} + \\beta_{5}\\times othrace_{i} + u_{i} \\] 2.4.2 推定 library(AER) out_iv &lt;- ivreg( weeksm1 ~ morekids + agem1 + black + hispan + othrace | samesex + agem1 + black + hispan + othrace, data = df) 2.4.3 解釈 summary(out_iv) ## ## Call: ## ivreg(formula = weeksm1 ~ morekids + agem1 + black + hispan + ## othrace | samesex + agem1 + black + hispan + othrace, data = df) ## ## Residuals: ## Min 1Q Median 3Q Max ## -36.34 -17.66 -10.99 22.72 45.15 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -4.79189 0.40657 -11.786 &lt;2e-16 *** ## morekids -5.82105 1.24631 -4.671 3e-06 *** ## agem1 0.83160 0.02289 36.336 &lt;2e-16 *** ## black 11.62327 0.22893 50.772 &lt;2e-16 *** ## hispan 0.40418 0.25986 1.555 0.12 ## othrace 2.13096 0.20586 10.352 &lt;2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 21.38 on 254648 degrees of freedom ## Multiple R-Squared: 0.04368, Adjusted R-squared: 0.04366 ## Wald test: 1335 on 5 and 254648 DF, p-value: &lt; 2.2e-16 2.5 推定結果の整理 library(stargazer) out_OLS &lt;- lm(weeksm1 ~ morekids + agem1 + black + hispan + othrace , data = df) stargazer(out_OLS, out_iv, type=&quot;text&quot;) ## ## ============================================================================ ## Dependent variable: ## ------------------------------------------ ## weeksm1 ## OLS instrumental ## variable ## (1) (2) ## ---------------------------------------------------------------------------- ## morekids -6.230*** -5.821*** ## (0.088) (1.246) ## ## agem1 0.838*** 0.832*** ## (0.013) (0.023) ## ## black 11.664*** 11.623*** ## (0.192) (0.229) ## ## hispan 0.466*** 0.404 ## (0.179) (0.260) ## ## othrace 2.142*** 2.131*** ## (0.203) (0.206) ## ## Constant -4.835*** -4.792*** ## (0.385) (0.407) ## ## ---------------------------------------------------------------------------- ## Observations 254,654 254,654 ## R2 0.044 0.044 ## Adjusted R2 0.044 0.044 ## Residual Std. Error (df = 254648) 21.384 21.385 ## F Statistic 2,330.779*** (df = 5; 254648) ## ============================================================================ ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 "],["DC.html", "Chapter 3 離散選択モデル 3.1 検証する仮説 3.2 データの読み込み 3.3 データの把握 3.4 推定 3.5 推定結果の整理", " Chapter 3 離散選択モデル 3.1 検証する仮説 「自社の店舗が多い地域ほど出店確率が高まるのでは？」という仮説を検証してみます。ドミナント戦略が取られていれば、この仮説通りになっているはず…。 3.2 データの読み込み df &lt;- read.csv(&#39;data/Mitaron_convenience.csv&#39;) head(df) ## Mesh_area Open_year Familymart_Entry LAWSON_Entry ## 1 362327851 2011 0 0 ## 2 362327851 2012 0 0 ## 3 362327851 2013 1 0 ## 4 362327851 2014 0 0 ## 5 362327851 2015 0 0 ## 6 362327851 2016 0 0 ## Familymart_existed LAWSON_existed pop n_employee ## 1 0 0 13 2 ## 2 0 0 13 2 ## 3 0 0 13 2 ## 4 1 0 13 2 ## 5 1 0 10 2 ## 6 1 0 10 2 ## super_count F_count L_count ## 1 1 1 0 ## 2 1 1 0 ## 3 1 1 0 ## 4 1 1 0 ## 5 1 1 0 ## 6 1 1 0 3.3 データの把握 summary(df) ## Mesh_area Open_year Familymart_Entry ## Min. :362327851 Min. :2011 Min. :0.00000 ## 1st Qu.:392725222 1st Qu.:2013 1st Qu.:0.00000 ## Median :392726806 Median :2014 Median :0.00000 ## Mean :389777896 Mean :2014 Mean :0.08962 ## 3rd Qu.:392746145 3rd Qu.:2016 3rd Qu.:0.00000 ## Max. :402707402 Max. :2018 Max. :1.00000 ## LAWSON_Entry Familymart_existed LAWSON_existed ## Min. :0.00000 Min. :0.0000 Min. :0.0000 ## 1st Qu.:0.00000 1st Qu.:0.0000 1st Qu.:0.0000 ## Median :0.00000 Median :0.0000 Median :0.0000 ## Mean :0.05601 Mean :0.4611 Mean :0.3626 ## 3rd Qu.:0.00000 3rd Qu.:1.0000 3rd Qu.:1.0000 ## Max. :1.00000 Max. :5.0000 Max. :5.0000 ## pop n_employee super_count ## Min. : 1.0 Min. : 2.0 Min. :0.0000 ## 1st Qu.: 539.8 1st Qu.: 102.0 1st Qu.:0.0000 ## Median :1224.5 Median : 279.0 Median :0.0000 ## Mean :1484.6 Mean : 611.7 Mean :0.5377 ## 3rd Qu.:2140.5 3rd Qu.: 705.0 3rd Qu.:1.0000 ## Max. :5244.0 Max. :12554.0 Max. :8.0000 ## F_count L_count ## Min. :0.0000 Min. :0.0000 ## 1st Qu.:0.0000 1st Qu.:0.0000 ## Median :1.0000 Median :0.0000 ## Mean :0.7264 Mean :0.4764 ## 3rd Qu.:1.0000 3rd Qu.:1.0000 ## Max. :3.0000 Max. :2.0000 3.4 推定 3.4.1 計量経済学モデル \\[ Familymart\\_Entry = \\begin{cases} 1 &amp; (\\lambda_i \\ge \\mu) \\\\ 0 &amp; (\\lambda_i &lt; \\mu) \\end{cases} \\] \\[ \\lambda_{i} = \\alpha + \\beta_{1}\\times Familymart\\_existed_{i}+ \\beta_{2}\\times pop_{i} + u_{i} \\] \\[ P(Familymart\\_Entry = 1) = F(\\alpha + \\beta_{1}\\times Familymart\\_existed_{i}+ \\beta_{2}\\times pop_{i} + u_{i} ) \\] 3.4.2 ロジットモデル out_logit = glm( Familymart_Entry ~ Familymart_existed + pop, family = binomial(link = &quot;logit&quot;), data = df) 3.4.3 解釈 summary(out_logit) ## ## Call: ## glm(formula = Familymart_Entry ~ Familymart_existed + pop, family = binomial(link = &quot;logit&quot;), ## data = df) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -0.7445 -0.4593 -0.4129 -0.3569 3.0002 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -2.502e+00 1.439e-01 -17.385 &lt; 2e-16 ## Familymart_existed -5.813e-01 1.589e-01 -3.659 0.000253 ## pop 2.595e-04 7.334e-05 3.538 0.000404 ## ## (Intercept) *** ## Familymart_existed *** ## pop *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 1023.2 on 1695 degrees of freedom ## Residual deviance: 1002.4 on 1693 degrees of freedom ## AIC: 1008.4 ## ## Number of Fisher Scoring iterations: 5 library(margins) summary(margins(out_logit)) ## factor AME SE z p lower ## Familymart_existed -0.0468 0.0130 -3.6026 0.0003 -0.0723 ## pop 0.0000 0.0000 3.4951 0.0005 0.0000 ## upper ## -0.0214 ## 0.0000 3.4.4 プロビットモデル out_probit = glm( Familymart_Entry ~ Familymart_existed + pop, family = binomial(link = &quot;probit&quot;), data = df) 3.4.5 解釈 summary(out_probit) ## ## Call: ## glm(formula = Familymart_Entry ~ Familymart_existed + pop, family = binomial(link = &quot;probit&quot;), ## data = df) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -0.7137 -0.4597 -0.4145 -0.3627 3.0476 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -1.438e+00 7.199e-02 -19.976 &lt; 2e-16 ## Familymart_existed -2.681e-01 7.584e-02 -3.535 0.000408 ## pop 1.300e-04 3.818e-05 3.406 0.000659 ## ## (Intercept) *** ## Familymart_existed *** ## pop *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 1023.2 on 1695 degrees of freedom ## Residual deviance: 1003.3 on 1693 degrees of freedom ## AIC: 1009.3 ## ## Number of Fisher Scoring iterations: 5 summary(margins(out_probit)) ## factor AME SE z p lower ## Familymart_existed -0.0426 0.0121 -3.5112 0.0004 -0.0664 ## pop 0.0000 0.0000 3.3889 0.0007 0.0000 ## upper ## -0.0188 ## 0.0000 3.5 推定結果の整理 library(stargazer) out_OLS &lt;- lm(Familymart_Entry ~ Familymart_existed + pop, data = df) stargazer(out_OLS, out_logit, out_probit, type=&quot;text&quot;) ## ## =============================================================== ## Dependent variable: ## ------------------------------------------- ## Familymart_Entry ## OLS logistic probit ## (1) (2) (3) ## --------------------------------------------------------------- ## Familymart_existed -0.039*** -0.581*** -0.268*** ## (0.010) (0.159) (0.076) ## ## pop 0.00002*** 0.0003*** 0.0001*** ## (0.00001) (0.0001) (0.00004) ## ## Constant 0.076*** -2.502*** -1.438*** ## (0.011) (0.144) (0.072) ## ## --------------------------------------------------------------- ## Observations 1,696 1,696 1,696 ## R2 0.011 ## Adjusted R2 0.010 ## Log Likelihood -501.215 -501.668 ## Akaike Inf. Crit. 1,008.430 1,009.337 ## Residual Std. Error 0.284 (df = 1693) ## F Statistic 9.840*** (df = 2; 1693) ## =============================================================== ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 "],["PANEL.html", "Chapter 4 パネルデータ分析 4.1 検証する仮説 4.2 データの読み込み 4.3 データの把握 4.4 推定 4.5 推定結果の整理", " Chapter 4 パネルデータ分析 4.1 検証する仮説 「当該路線上で市場集中度が高いほど、運賃は高くなるのでは？」という仮説を検証してみます。市場集中度を示す値として、今回の分析では各路線上でトップシェアを誇るエアラインの市場シェアを使って分析していきます。 4.2 データの読み込み library(openxlsx) df &lt;- read.xlsx(&quot;data/airfare.xlsx&quot;) head(df) ## year origin destin dist passen fare bmktshr ## 1 1997 &quot;AKRON, OH&quot; &quot;ATLANTA, GA&quot; 528 152 106 0.8386 ## 2 1998 &quot;AKRON, OH&quot; &quot;ATLANTA, GA&quot; 528 265 106 0.8133 ## 3 1999 &quot;AKRON, OH&quot; &quot;ATLANTA, GA&quot; 528 336 113 0.8262 ## 4 2000 &quot;AKRON, OH&quot; &quot;ATLANTA, GA&quot; 528 298 123 0.8612 ## 5 1997 &quot;AKRON, OH&quot; &quot;ORLANDO, FL&quot; 861 282 104 0.5798 ## 6 1998 &quot;AKRON, OH&quot; &quot;ORLANDO, FL&quot; 861 178 105 0.5817 ## ID ## 1 1 ## 2 1 ## 3 1 ## 4 1 ## 5 2 ## 6 2 4.3 データの把握 4.3.1 基本統計量 summary(df) ## year origin destin ## Min. :1997 Length:4596 Length:4596 ## 1st Qu.:1998 Class :character Class :character ## Median :1998 Mode :character Mode :character ## Mean :1998 ## 3rd Qu.:1999 ## Max. :2000 ## dist passen fare ## Min. : 95.0 Min. : 2.0 Min. : 37.0 ## 1st Qu.: 505.0 1st Qu.: 215.0 1st Qu.:123.0 ## Median : 861.0 Median : 357.0 Median :168.0 ## Mean : 989.7 Mean : 636.8 Mean :178.8 ## 3rd Qu.:1304.0 3rd Qu.: 717.0 3rd Qu.:225.0 ## Max. :2724.0 Max. :8497.0 Max. :522.0 ## bmktshr ID ## Min. :0.1605 Min. : 1 ## 1st Qu.:0.4650 1st Qu.: 288 ## Median :0.6039 Median : 575 ## Mean :0.6101 Mean : 575 ## 3rd Qu.:0.7531 3rd Qu.: 862 ## Max. :1.0000 Max. :1149 4.3.2 データの可視化 library(ggpubr) gghistogram(df, x = &quot;fare&quot;, bins = 30, title = &quot;Histogram of fare&quot;) 4.3.3 対数変換 df$ln_fare &lt;- log(df$fare) gghistogram(df, x = &quot;ln_fare&quot;, bins = 30, title = &quot;Histogram of ln_fare&quot;) 4.4 推定 4.4.1 計量経済学モデル \\[ ln\\_fare_{i,t} = \\alpha + \\beta_{1}\\times bmktshr_{i,t}+ \\beta_{2}\\times dist_{i,t}+ \\beta_{3}\\times passen_{i,t}+ F_i + u_{i,t} \\] 4.4.2 準備 library(plm) df_panel &lt;- pdata.frame(df, index = c(&#39;ID&#39;, &#39;year&#39;)) 4.4.3 変量効果モデル out_random &lt;- plm(ln_fare ~ bmktshr+ dist + passen , data = df_panel, model = &quot;random&quot;) summary(out_random) ## Oneway (individual) effect Random Effect Model ## (Swamy-Arora&#39;s transformation) ## ## Call: ## plm(formula = ln_fare ~ bmktshr + dist + passen, data = df_panel, ## model = &quot;random&quot;) ## ## Balanced Panel: n = 1149, T = 4, N = 4596 ## ## Effects: ## var std.dev share ## idiosyncratic 0.01182 0.10871 0.103 ## individual 0.10290 0.32078 0.897 ## theta: 0.8329 ## ## Residuals: ## Min. 1st Qu. Median 3rd Qu. Max. ## -0.87882871 -0.06663365 -0.00065108 0.06643019 0.89768536 ## ## Coefficients: ## Estimate Std. Error z-value Pr(&gt;|z|) ## (Intercept) 4.7083e+00 2.9902e-02 157.4573 &lt; 2.2e-16 *** ## bmktshr 9.0534e-02 2.7385e-02 3.3059 0.0009466 *** ## dist 4.3095e-04 1.6696e-05 25.8108 &lt; 2.2e-16 *** ## passen -1.4828e-04 9.6610e-06 -15.3481 &lt; 2.2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Total Sum of Squares: 68.334 ## Residual Sum of Squares: 56.06 ## R-Squared: 0.17962 ## Adj. R-Squared: 0.17908 ## Chisq: 1005.39 on 3 DF, p-value: &lt; 2.22e-16 4.4.4 固定効果モデル out_fix &lt;- plm(ln_fare ~ bmktshr+ dist + passen , data = df_panel, model = &quot;within&quot;) summary(out_fix) ## Oneway (individual) effect Within Model ## ## Call: ## plm(formula = ln_fare ~ bmktshr + dist + passen, data = df_panel, ## model = &quot;within&quot;) ## ## Balanced Panel: n = 1149, T = 4, N = 4596 ## ## Residuals: ## Min. 1st Qu. Median 3rd Qu. Max. ## -0.88515181 -0.04866045 -0.00023397 0.05151268 0.95497340 ## ## Coefficients: ## Estimate Std. Error t-value Pr(&gt;|t|) ## bmktshr 0.02373293 0.03000237 0.791 0.429 ## passen -0.00029409 0.00001540 -19.097 &lt;2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Total Sum of Squares: 45.169 ## Residual Sum of Squares: 40.716 ## R-Squared: 0.098576 ## Adj. R-Squared: -0.20234 ## F-statistic: 188.365 on 2 and 3445 DF, p-value: &lt; 2.22e-16 固定効果自体はfixefで取り出せます。 mean(fixef(out_fix)) ## [1] 5.268405 4.4.5 ハウスマン検定 phtest(out_fix, out_random) ## ## Hausman Test ## ## data: ln_fare ~ bmktshr + dist + passen ## chisq = 157.91, df = 2, p-value &lt; 2.2e-16 ## alternative hypothesis: one model is inconsistent 4.4.6 固定効果×時間効果 \\[ ln\\_fare_{i,t} = \\alpha + \\beta_{1}\\times bmktshr_{i,t}+ \\beta_{2}\\times dist_{i,t}+ \\beta_{3}\\times passen_{i,t}+ F_i +y\\_1997_{i, t} +y\\_1998_{i, t} +y\\_1999_{i, t} + u_{i,t} \\] out_fix_time &lt;- plm(ln_fare ~ bmktshr+ dist + passen , data = df_panel, effect = &quot;twoways&quot;, model = &quot;within&quot;) summary(out_fix_time) ## Twoways effects Within Model ## ## Call: ## plm(formula = ln_fare ~ bmktshr + dist + passen, data = df_panel, ## effect = &quot;twoways&quot;, model = &quot;within&quot;) ## ## Balanced Panel: n = 1149, T = 4, N = 4596 ## ## Residuals: ## Min. 1st Qu. Median 3rd Qu. Max. ## -0.819590 -0.035576 0.001385 0.037447 0.872410 ## ## Coefficients: ## Estimate Std. Error t-value Pr(&gt;|t|) ## bmktshr 8.3408e-02 2.6626e-02 3.1326 0.001747 ** ## passen -4.0067e-04 1.4055e-05 -28.5066 &lt; 2.2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Total Sum of Squares: 39.434 ## Residual Sum of Squares: 31.6 ## R-Squared: 0.19867 ## Adj. R-Squared: -0.069759 ## F-statistic: 426.68 on 2 and 3442 DF, p-value: &lt; 2.22e-16 4.5 推定結果の整理 library(stargazer) out_OLS &lt;- lm(ln_fare ~ bmktshr+ dist + passen , data = df) stargazer(out_OLS, out_fix, out_random, out_fix_time, type=&quot;text&quot;) ## ## ================================================================================================================ ## Dependent variable: ## -------------------------------------------------------------------------------------------- ## ln_fare ## OLS panel ## linear ## (1) (2) (3) (4) ## ---------------------------------------------------------------------------------------------------------------- ## bmktshr 0.261*** 0.024 0.091*** 0.083*** ## (0.030) (0.030) (0.027) (0.027) ## ## dist 0.0005*** 0.0004*** ## (0.00001) (0.00002) ## ## passen -0.0001*** -0.0003*** -0.0001*** -0.0004*** ## (0.00001) (0.00002) (0.00001) (0.00001) ## ## Constant 4.508*** 4.708*** ## (0.027) (0.030) ## ## ---------------------------------------------------------------------------------------------------------------- ## Observations 4,596 4,596 4,596 4,596 ## R2 0.396 0.099 0.180 0.199 ## Adjusted R2 0.395 -0.202 0.179 -0.070 ## Residual Std. Error 0.339 (df = 4592) ## F Statistic 1,002.387*** (df = 3; 4592) 188.365*** (df = 2; 3445) 1,005.385*** 426.680*** (df = 2; 3442) ## ================================================================================================================ ## Note: *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01 "]]
